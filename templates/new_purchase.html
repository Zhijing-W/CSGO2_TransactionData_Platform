{% extends "base.html" %}

{% block title %}Add New Purchase{% endblock %}

{% block content %}
    <p><a href="{{ url_for('home') }}">&larr; Back to Home</a></p>
    
    <h1>Add a New Purchase Record</h1>
    <p>This will add a purchase record. If the item (name + exterior) does not exist in the catalog, it will be created.</p>

    <form action="{{ url_for('purchase_create') }}" method="POST">
        
        <fieldset>
            <legend>Item Details (Get-or-Create)</legend>
            <div>
                <label for="market_name">Market Name:</label>
                <input type="text" id="market_name" name="market_name" placeholder="e.g., AWP | Asiimov" required>
            </div>
            <div>
                <label for="exterior">Exterior (Wear):</label>
                <select id="exterior" name="exterior" required>
                    <option value="">-- Select Wear --</option>
                    <option value="Factory New">Factory New</option>
                    <option value="Minimal Wear">Minimal Wear</option>
                    <option value="Field-Tested">Field-Tested</option>
                    <option value="Well-Worn">Well-Worn</option>
                    <option value="Battle-Scarred">Battle-Scarred</option>
                </select>
            </div>
        </fieldset>

        <fieldset>
            <legend>Transaction Details</legend>
            <div>
                <label for="user_id">User:</label>
                <select id="user_id" name="user_id" required>
                    <option value="">-- Select User --</option>
                    {% for user in users %}
                        <option value="{{ user.user_id }}">{{ user.display_name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div>
                <label for="platform_id">Platform:</label>
                <select id="platform_id" name="platform_id" required>
                    <option value="">-- Select Platform --</option>
                    {% for platform in platforms %}
                        <option value="{{ platform.platform_id }}">{{ platform.platform_name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div>
                <label for="price">Price:</label>
                <input type="number" step="0.01" id="price" name="price" placeholder="e.g., 220.50" required>
            </div>
            <div>
                <label for="currency">Currency:</label>
                <select id="currency" name="currency" required>
                    <option value="USD">USD</option>
                    <option value="EUR">EUR</option>
                    <option value="CNY">CNY</option>
                    <option value="GBP">GBP</option>
                </select>
            </div>
            <div>
                <label for="ts">Date of Purchase:</label>
                <input type="datetime-local" id="ts" name="ts" required>
            </div>
        </fieldset>
        
        <div>
            <button type="submit">Add Purchase</button>
        </div>
    </form>
{% endblock %}
