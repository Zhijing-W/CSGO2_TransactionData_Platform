{% extends "base.html" %}

{% block title %}Holdings for {{ current_user.display_name }}{% endblock %}

{% block content %}
    <h1>Holdings for {{ current_user.display_name }}</h1>
    <p>This page shows all items you currently hold, their average cost, current market value, and unrealized profit/loss.</p>

    <table>
        <thead>
            <tr>
                <th>Item Name</th>
                <th>Exterior</th>
                <th>Qty Held</th>
                <th>Avg. Buy Cost</th>
                <th>Current Market Price</th>
                <th>Unrealized PnL</th>
            </tr>
        </thead>
        <tbody>
            {% for item in holdings %}
            <tr>
                <td>
                    <a href="{{ url_for('item_detail', item_id=item.item_id) }}">
                        {{ item.market_name }}
                    </a>
                </td>
                <td>{{ item.exterior }}</td>
                <td>{{ item.quantity_held }}</td>
                <td>{{ "%.2f"|format(item.avg_buy_cost or 0) }}</td>
                <td>{{ "%.2f"|format(item.market_price or 0) }}</td>
                
                {% set pnl = item.unrealized_pnl or 0 %}
                {% if pnl > 0 %}
                    <td style="color: green;">
                        +{{ "%.2f"|format(pnl) }}
                    </td>
                {% else %}
                    <td style="color: red;">
                        {{ "%.2f"|format(pnl) }}
                    </td>
                {% endif %}
            </tr>
            {% else %}
            <tr>
                <td colspan="6">You are not currently holding any items. Add a purchase to get started.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}